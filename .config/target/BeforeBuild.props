<Project>
    <ItemGroup>
        <GeneratorProjects Include="$(SolutionDir)4_Operation/Ecs/generator/Alis.Core.Ecs.Generator.csproj">
            <OutputAssembly>$(SolutionDir)4_Operation/Ecs/generator/bin/Release/netstandard2.0/Alis.Core.Ecs.Generator.dll</OutputAssembly>
        </GeneratorProjects>

        <GeneratorProjects Include="$(SolutionDir)6_Ideation/Data/generator/Alis.Core.Aspect.Data.Generator.csproj">
            <OutputAssembly>$(SolutionDir)6_Ideation/Data/generator/bin/Release/netstandard2.0/Alis.Core.Aspect.Data.Generator.dll</OutputAssembly>
        </GeneratorProjects>
    </ItemGroup>

    <Target Name="BuildAllGenerators"
            BeforeTargets="Build;Publish"
            Condition="'$(Configuration)' == 'Release' AND $(AssemblyName.Contains('Generator')) == false"
            Inputs="@(GeneratorProjects)"
            Outputs="@(GeneratorProjects->'%(OutputAssembly)')">

        <Message Importance="high" Text="Checking if generator DLLs need to be built..." />

        <MSBuild
            Projects="@(GeneratorProjects)"
            Properties="Configuration=Release;TargetFramework=netstandard2.0"
            Targets="Build" />

        <Message Importance="high" Text="All generators built successfully." />
    </Target>
</Project>
