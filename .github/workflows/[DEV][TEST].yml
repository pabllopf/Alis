name: "[DEV][TEST]"

on:
  push:
    branches: [ master ]
    paths-ignore:
      - 'docs/**'
      - '**.md'
      - '.git/**'
      - '.config/**'

jobs:
  Run_Test_On_MacOs_Latest:
    runs-on: macos-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          ref: master
          
      - name: chmod
        run: chmod +x dotnet-install.sh

      - name: install dotnet 3.0
        run: ./dotnet-install.sh --architecture x64 --runtime dotnet --version 3.0.0 --channel LTS

      - name: install dotnet 3.1
        run: ./dotnet-install.sh --architecture x64 --runtime dotnet --version 3.1.0 --channel LTS

      - name: install dotnet 5
        run: ./dotnet-install.sh --architecture x64 --runtime dotnet --version 5.0.0 --channel LTS
        
      - name: install dotnet 6
        run: ./dotnet-install.sh --architecture x64 --runtime dotnet --version 6.0.0 --channel LTS

      - name: install dotnet 7
        run: ./dotnet-install.sh --architecture x64 --runtime dotnet --version 7.0.0 --channel LTS

      - name: install dotnet 8
        run: ./dotnet-install.sh --architecture x64 --runtime dotnet --version 8.0.0 --channel LTS

      - name: Setup dotnet
        uses: actions/checkout@v4
        with:
          dotnet-version: |
            3.0.103
            3.1.426
            5.0.408
            6.0.420
            7.0.408
            8.0.202

      - name: brew install icu4c
        run: brew install icu4c

      - name: brew install openssl
        run: brew install openssl

      - name: update
        run: brew update

      - name: mono-libgdiplus
        run: brew install mono-libgdiplus
          
      - name: Dotnet test Debug
        run: dotnet test alis.sln -c Debug
  
  Run_Test_On_Windows_Latest:
    runs-on: windows-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          ref: master

      - name: Setup dotnet
        uses: actions/checkout@v4
        with:
          dotnet-version: |
            3.0.x
            3.1.x
            5.0.x
            6.0.x
            7.0.x
            8.0.x

      - name: Dotnet test Debug
        run: dotnet test alis.sln -c Debug
  
  Run_Test_On_Ubuntu_Latest:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          ref: master

      - name: Setup dotnet
        uses: actions/checkout@v4
        with:
          dotnet-version: |
            3.0.x
            3.1.x
            5.0.x
            6.0.x
            7.0.x
            8.0.x

      - name: Dotnet test Debug
        run: dotnet test alis.sln -c Debug
