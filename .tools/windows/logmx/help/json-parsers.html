<HTML>
<HEAD>
<TITLE>LogMX JSON Parsers</TITLE>
<STYLE type="text/css" media="all">
body { background-color: #FFFFFF; }
body, td, th {
	font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif, Times New Roman;
	color:#000000;
	cursor: default;
}

a:link, a:visited, a:active, .LinkColor { 
	text-decoration: none; 
	color: #349EF9;
	transition: color 0.3s;
}

a:hover, a.LinkHover {
	color: #91CFFF; 
	transition: color 0.3s;
}

.JsonText, .InlineJsonText {
    font-family: monospace;
    font-weight: bold;
    line-height: 100%;
    color: #d65a02;
}

.JsonText {
    white-space: pre;
    display: block;
}

.Center {
    text-align: center;
}

.VertMargins {
    margin-top: 10px;
    margin-bottom: 10px;
}

.JsonParserTable td, .JsonParserTable th {
    text-align:left;
}
.JsonParserTable td:nth-child(1), .JsonParserTable th:nth-child(1) {
    text-align:right;
}

.NoteOuter {
    width: 100%;
}
.Note {
    width: 80%;
    font-size: 90%;
    text-align: justify;
    background-color: #d1efff;
    border: 1px solid #c0ddec;
    margin: auto;
    padding: 5px 9px 5px 9px;
}

table.Tab0 {
    border-spacing: 0px;
}

table.Tab0, table.Tab0 td, table.Tab0 th {
	border-style: solid;
	border-color: #b6b6b6;
	border-left-width: 1px;
	border-top-width: 1px;
	border-right-width: 0px;
	border-bottom-width: 0px;
}
table.Tab0 td, table.Tab0 th {
    padding: 4px 4px 4px 4px;  
	border-left-width: 0px;
	border-top-width: 0px;
	border-right-width: 1px;
	border-bottom-width: 1px;
}
table.Tab0 th, .TableHeader {
	font-weight: bold;
	background-color: #FFF8EF; /* = $COLOR_LIGHT_ORANGE */
}




.Field1 { background-color: #c3ffd7; }
.Field2 { background-color: #d1c3ff; }
.Field3 { background-color: #ffe0c3; }

body {line-height : 150%; }

.ExampleTitle, .ExampleTitleTOC { font-weight: bold; margin-bottom: 10px; margin-top: 40px;}
.ExampleTitle { font-size: 140%; margin-bottom: 10px; margin-top: 40px;}
.ExampleTitleTOC { font-size: 110%;  }
</STYLE>
</HEAD>

<BODY style="background-color: #FFFFFF;">
<DIV style="font-size: 150%"><B>LogMX <I>JSON</I> Parsers</B></DIV>
<BR>
If your logs files are using a JSON syntax, you can use LogMX JSON parsers to extract a list of
JSON fields to build log entries.<BR>
To create or edit a LogMX JSON Parser, go to menu "Tools", item "Options", then tab "Parsers".
<BR>

<DIV class="ExampleTitle">Table of contents:</DIV>
<DIV class="ExampleTitleTOC" style="margin-top: 10px;">
    <A href="#Ex1">Example 1 - Simple JSON structure</A><BR/>
    <A href="#Ex2">Example 2 - Nested JSON objects</A><BR/>
    <A href="#Ex3">Example 3 - JSON arrays</A><BR/>
    <A href="#Ex4">Example 4 - Special characters in JSON field names</A><BR/>
    <A href="#Ex5">Example 5 - User-defined log entry fields</A><BR/>
</DIV>

<DIV class="ExampleTitle"><A name="Ex1"></A>Example 1 - Simple JSON structure</DIV>

To parse the following JSON log file:
<DIV class="JsonText VertMargins">{
   <SPAN class="Field1">"date"    : "01/05/2020 10:12:32"</SPAN>,
   <SPAN class="Field2">"level"   : "INFO"</SPAN>,
   <SPAN class="Field3">"message" : "Hello, world!"</SPAN>
}</DIV>

You can extract the following JSON fields to associate them with these log entry fields:

<TABLE class="JsonParserTable Tab0 VertMargins">
  <TR>
    <TH>JSON field</TH>
    <TH>Log entry field</TH>
    <TH>Log entry field value</TH>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field1">"date"</SPAN></TD>
    <TD>Log entry date</TD>
    <TD><SPAN class="JsonText Field1">01/05/2020 10:12:32</SPAN></TD>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field2">"level"</SPAN></TD>
    <TD>Log entry log level</TD>
    <TD><SPAN class="JsonText Field2">INFO</SPAN></TD>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field3">"message"</SPAN></TD>
    <TD>Log entry message</TD>
    <TD><SPAN class="JsonText Field3">Hello, world!</SPAN></TD>
  </TR>
</TABLE>     

For that, you can set up the LogMX JSON Parser this way:
<BR>  
<IMG src="images/json-parser-1.png"></IMG>
<BR>  
<BR>  

<DIV class="NoteOuter">
    <DIV class="Note">
        <B>Note: </B> The whole log file doesn't have to be a valid JSON structure, 
        but each individual JSON object you want to use (to build log entries) should be a valid JSON structure. 
        For example, if the log file starts with the character '[' to start an array,
        this file doesn't have to finish with ']' to be parsed (a lot of JSON files are actually not valid 
        JSON because they are written as streams and the nature of JSON syntax makes it hard
        to keep the root object/array always closed).   
    </DIV>
</DIV>

<DIV class="ExampleTitle"><A name="Ex2"></A>Example 2 - Nested JSON objects</DIV>

LogMX JSON Parsers also let you extract fields from child nodes (i.e. objects of objects). For example, to parse the following JSON log file:
<DIV class="JsonText VertMargins">{
    <SPAN class="Field1">"date"  : "01/05/2020 10:12:32"</SPAN>,
    "event" : {
         <SPAN class="Field2">"message" : "Hello, world!"</SPAN>,
         "system"  : {
              <SPAN class="Field3">"name" : "System 1"</SPAN>,
              "SN"   : "FSG423"
         }
    }
}</DIV>

You can extract the following JSON fields to associate them with these log entry fields:

<TABLE class="JsonParserTable Tab0 VertMargins">
  <TR>
    <TH>JSON field</TH>
    <TH>Log entry field</TH>
    <TH>Log entry field value</TH>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field1">"date"</SPAN></TD>
    <TD>Log entry date</TD>
    <TD><SPAN class="JsonText Field1">01/05/2020 10:12:32</SPAN></TD>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field2">"event/message"</SPAN></TD>
    <TD>Log entry message</TD>
    <TD><SPAN class="JsonText Field2">Hello, world!</SPAN></TD>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field3">"event/system/name"</SPAN></TD>
    <TD>Log entry emitter</TD>
    <TD><SPAN class="JsonText Field3">System 1</SPAN></TD>
  </TR>
</TABLE>     

For that, you can set up the LogMX JSON Parser this way:
<BR>  
<IMG src="images/json-parser-2.png"></IMG>
<BR>  
<BR>  

In order to point a specific JSON child object, LogMX uses <i>"JSON pointers"</i>, as described by RFC 6901 
(see <A href="https://tools.ietf.org/html/rfc6901">https://tools.ietf.org/html/rfc6901</A>).
The only difference between RFC 6901 JSON pointers and LogMX JSON pointers is that the first leading 
slash '/' is optional for LogMX (mandatory in RFC 6901). That is why the examples given on this page use JSON field pointers
like <SPAN class="InlineJsonText">"event/message"</SPAN> (it doesn't start with '/'). 
Using <SPAN class="InlineJsonText">"/event/message"</SPAN> would also work. This is to keep LogMX 
Parsers more intuitive, and also to represent the "relative" handling of JSON objects: these fields 
pointers are not "absolute" starting at the document root, but are relative to any arbitrary JSON object
used to extract log entries. 
<BR>  
<BR>  
<DIV class="NoteOuter">
    <DIV class="Note">
        <B>Note: </B> In order to create your Parser faster, you can ask LogMX to generate the list of all
        the fields present in your logs. To do so, paste a few log entries in the blue text area 
        (<i>"Parser test"</i> panel), then click on the button <i>"Generate fields from logs sample below"</i>.
        All the fields will then be present at the top of the window: simply choose a log entry field to 
        associate to each JSON field, and remove the fields you don't want to ingest.
    </DIV>
</DIV>


<DIV class="ExampleTitle"><A name="Ex3"></A>Example 3 - JSON arrays</DIV>

LogMX JSON Parsers also let you extract data from arrays, as described in RFC 6901.
For example, to parse the following JSON log file:
<DIV class="JsonText VertMargins">{
    <SPAN class="Field1">"date"  : "01/05/2020 10:12:32"</SPAN>,
    "event" : {
         <SPAN class="Field2">"message" : "Hello, world!"</SPAN>,
         "system"  : {
              <SPAN class="Field3">"names" : ["System 1", "Sys1", "ABD1"]</SPAN>,
              "SN"   : "FSG423"
         }
    }
}</DIV>

You can extract the following JSON fields to associate them with these log entry fields:

<TABLE class="JsonParserTable Tab0 VertMargins">
  <TR>
    <TH>JSON field</TH>
    <TH>Log entry field</TH>
    <TH>Log entry field value</TH>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field1">"date"</SPAN></TD>
    <TD>Log entry date</TD>
    <TD><SPAN class="JsonText Field1">01/05/2020 10:12:32</TD>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field2">"event/message"</SPAN></TD>
    <TD>Log entry message</TD>
    <TD><SPAN class="JsonText Field2">Hello, world!</SPAN></TD>
  </TR>
  <TR>
    <TD><SPAN class="JsonText Field3">"event/system/names/1"</SPAN></TD>
    <TD>Log entry emitter</TD>
    <TD><SPAN class="JsonText Field3">Sys1</SPAN></TD>
  </TR>
</TABLE>     


<DIV class="ExampleTitle"><A name="Ex4"></A>Example 4 - Special characters in JSON field names</DIV>
As described in RFC 6901, the following characters in JSON field names should be replaced with the 
following characters in the JSON pointers:
<TABLE class="Tab0 VertMargins">
  <TR>
    <TH>JSON field character</TH>
    <TH>JSON pointer character</TH>
    <TH>Example</TH>
  </TR>
  <TR>
    <TD class="Center"><SPAN class="InlineJsonText">/</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">~1</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">"P/N"</SPAN>&nbsp; &#x1f846; &nbsp;<SPAN class="InlineJsonText">"P~1N"</SPAN> </TD>
  </TR>
  <TR>
    <TD class="Center"><SPAN class="InlineJsonText">~</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">~0</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">"A~B"</SPAN>&nbsp; &#x1f846; &nbsp;<SPAN class="InlineJsonText">"A~0B"</SPAN> </TD>
  </TR>
  <TR>
    <TD class="Center"><SPAN class="InlineJsonText">\\</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">\</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">"A\\B"</SPAN>&nbsp; &#x1f846; &nbsp;<SPAN class="InlineJsonText">"A\B"</SPAN> </TD>
  </TR>
  <TR>
    <TD class="Center"><SPAN class="InlineJsonText">\"</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">"</SPAN></TD>
    <TD class="Center"><SPAN class="InlineJsonText">"A \"quoted\" word"</SPAN>&nbsp; &#x1f846; &nbsp;<SPAN class="InlineJsonText">"A "quoted" word"</SPAN> </TD>
  </TR>
</TABLE>  

Note that as of April 2020, the last two cases are still not officially part of RFC 6901, 
but an Errata to fix this RFC has been reported (see 
<A href="https://www.rfc-editor.org/errata/eid5745">Errata-5745</A>). 
We believe that <SPAN class="InlineJsonText">"\\"</SPAN> is the escaped string for the 
<SPAN class="InlineJsonText">"\"</SPAN> JSON character,
so the JSON pointer should be <SPAN class="InlineJsonText">"\"</SPAN> instead of 
<SPAN class="InlineJsonText">"\\"</SPAN> as suggested by RFC 6901 (same reasoning for 
<SPAN class="InlineJsonText">"\""</SPAN>).

<DIV class="ExampleTitle"><A name="Ex5"></A>Example 5 - User-defined log entry fields</DIV>
As other LogMX Parsers do, JSON Parsers let you use custom log entry fields: each log entry is not
just limited to the standard fields "Date", "Emitter", "Thread", "Level" and "Message". You can add 
any custom field, of any type (integer, string, float). To use such custom log entry fields, just
pick <i>"User-defined field..."</i> in the log entry field combo box:<BR>
<IMG src="images/json-parser-3.png"></IMG>
<BR>
<BR>

<BODY>
</HTML>