<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <TargetFramework>net8.0</TargetFramework>
        <OutputType>Exe</OutputType>
        <RuntimeIdentifier Condition="'$(RuntimeIdentifier)' == ''">$(NETCoreSdkRuntimeIdentifier)</RuntimeIdentifier>
        <OutDir>bin/$(Configuration)/$(RuntimeIdentifier)/lib/</OutDir>
        <LangVersion>13</LangVersion>
        <Nullable>disable</Nullable>
        <AllowUnsafeBlocks>false</AllowUnsafeBlocks>
        <SonarQubeExclude>true</SonarQubeExclude>
       
    </PropertyGroup>

    <PropertyGroup>
        <NoWarn>$(NoWarn);CS1685;</NoWarn> <!-- Error CS1685 : Warning As Error: Define on differente assemblys of alias gloabal -->
        <NoWarn>$(NoWarn);CS0436;</NoWarn> <!-- Error CS0436 : Warning As Error: Overriding dependency version -->
        <NoWarn>$(NoWarn);NU1903;</NoWarn> <!-- Error NU1903 : Warning As Error: Package has high severity vulnerability -->
        <NoWarn>$(NoWarn);NU1902;</NoWarn> <!-- Error NU1902 : Warning As Error: Package has moderate severity vulnerabilities -->
        <NoWarn>$(NoWarn);CS0162;</NoWarn>
        <NoWarn>$(NoWarn);ALIS001;ALIS009;ALIS010;ALIS007;ALIS003;</NoWarn>
    </PropertyGroup>

    <PropertyGroup>
        <DefineConstants Condition="'$(RuntimeIdentifier)' != ''">$(DefineConstants);$([System.String]::Copy('$(RuntimeIdentifier)').Replace('-',''));</DefineConstants>
        <DefineConstants Condition="'$(RuntimeIdentifier)' == ''" >$([System.String]::Copy('$(NETCoreSdkRuntimeIdentifier)').Replace('-',''));</DefineConstants>
    </PropertyGroup>


    <PropertyGroup Condition="($([MSBuild]::IsOSPlatform('linux')) AND '$(RuntimeIdentifier)' == '') OR $(RuntimeIdentifier.Contains('linux'))">
        <DefineConstants>$(DefineConstants);LINUX</DefineConstants>
        <IsLinux>true</IsLinux>
    </PropertyGroup>

    <PropertyGroup Condition="($([MSBuild]::IsOSPlatform('osx')) AND '$(RuntimeIdentifier)' == '')  OR $(RuntimeIdentifier.Contains('osx'))">
        <DefineConstants>$(DefineConstants);OSX</DefineConstants>
        <IsOSX>true</IsOSX>
    </PropertyGroup>

    <PropertyGroup Condition="($([MSBuild]::IsOSPlatform('windows')) AND '$(RuntimeIdentifier)' == '') OR $(RuntimeIdentifier.Contains('win'))">
        <DefineConstants>$(DefineConstants);WIN</DefineConstants>
        <IsWindows>true</IsWindows>
    </PropertyGroup>

    <ItemGroup>
        <AssemblyAttribute Include="System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute"/>
    </ItemGroup>
    
   

    <ItemGroup>
        <ProjectReference
            Include="
          $(SolutionDir)4_Operation/**/**/generator/**/*Generator.csproj;
          $(SolutionDir)6_Ideation/**/**/generator/**/*Generator.csproj;"
            OutputItemType="Analyzer"
            PrivateAssets="all"
            ReferenceOutputAssembly="false"/>
    </ItemGroup>

    <ItemGroup>
        <ProjectReference Include="$(SolutionDir)2_Application/**/**/src/**/Alis.csproj;"/>
        <ProjectReference Include="$(SolutionDir)1_Presentation/**/**/src/**/Alis.Extension.*.csproj;"/>
    </ItemGroup>


    <Target Name="BuildAndCopyEngineOutput" AfterTargets="Build;Publish" Condition="$(AssemblyName.Equals('Alis.App.Hub'))">
        <MSBuild Projects="$(SolutionDir)1_Presentation/Engine/src/Alis.App.Engine.csproj" Targets="Build" Properties="Configuration=$(Configuration)"/>
        <PropertyGroup>
            <EngineOutputDir>$(SolutionDir)1_Presentation/Engine/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/</EngineOutputDir>
            <DestinationDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/Editor/v$(AssemblyVersion)/</DestinationDir>
        </PropertyGroup>
        <ItemGroup>
            <EngineOutputFiles Include="$(EngineOutputDir)**/*"/>
        </ItemGroup>
        <RemoveDir Directories="$(DestinationDir)"/>
        <MakeDir Directories="$(DestinationDir)"/>
        <Copy SourceFiles="@(EngineOutputFiles)" DestinationFiles="@(EngineOutputFiles->'$(DestinationDir)%(RecursiveDir)%(Filename)%(Extension)')"/>
    </Target>

    <Target Name="BuildAndCopyInstallerOutput" AfterTargets="Build;Publish" Condition="$(AssemblyName.Equals('Alis.App.Hub'))">
        <MSBuild Projects="$(SolutionDir)1_Presentation/Installer/src/Alis.App.Installer.csproj" Targets="Build" Properties="Configuration=$(Configuration)"/>
        <PropertyGroup>
            <InstallerOutputDir>$(SolutionDir)1_Presentation/Installer/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/</InstallerOutputDir>
            <DestinationDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/Installer/</DestinationDir>
        </PropertyGroup>
        <ItemGroup>
            <InstallerOutputFiles Include="$(InstallerOutputDir)**/*"/>
        </ItemGroup>
        <RemoveDir Directories="$(DestinationDir)"/>
        <MakeDir Directories="$(DestinationDir)"/>
        <Copy SourceFiles="@(InstallerOutputFiles)" DestinationFiles="@(InstallerOutputFiles->'$(DestinationDir)%(RecursiveDir)%(Filename)%(Extension)')"/>
    </Target>

    <Target Name="CreateMacOsBundle"
            AfterTargets="Build;Publish"
            Condition="$(AssemblyName.Equals('Alis.App.Hub')) 
                   And '$(IsOSX)' == 'true' 
                   And $(Configuration) == 'Release'">

        <PropertyGroup>
            <AppBundleDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/publish/Alis.app/</AppBundleDir>
            <ContentsDir>$(AppBundleDir)Contents/</ContentsDir>
            <MacOSDir>$(ContentsDir)MacOS/</MacOSDir>
            <ResourcesDir>$(ContentsDir)Resources/</ResourcesDir>
            <HubOutputDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/</HubOutputDir>
            <DmgFileName>$(HubOutputDir)publish/Alis_$(RuntimeIdentifier).dmg</DmgFileName>
        </PropertyGroup>

        <!-- Limpiar bundle anterior -->
        <RemoveDir Directories="$(AppBundleDir)"/>

        <!-- Crear estructura de carpetas -->
        <MakeDir Directories="$(MacOSDir)"/>
        <MakeDir Directories="$(ResourcesDir)"/>

        <!-- Archivos del Hub (excepto el .app) -->
        <ItemGroup>
            <HubOutputFiles Include="$(HubOutputDir)**/*" Exclude="$(AppBundleDir)**/*"/>
        </ItemGroup>

        <Copy SourceFiles="$(SolutionDir)1_Presentation/Hub/src/Properties/Info.plist"
              DestinationFolder="$(ContentsDir)"/>
        <Copy SourceFiles="$(SolutionDir)1_Presentation/Hub/src/Properties/logo.png"
              DestinationFolder="$(ResourcesDir)"/>

        <Copy SourceFiles="@(HubOutputFiles)"
              DestinationFiles="@(HubOutputFiles->'$(MacOSDir)%(RecursiveDir)%(Filename)%(Extension)')"/>

        <!-- Copiar Editor si existe -->
        <ItemGroup>
            <EditorFiles Include="$(HubOutputDir)Editor/**/*"/>
        </ItemGroup>
        <Copy SourceFiles="@(EditorFiles)"
              DestinationFiles="@(EditorFiles->'$(MacOSDir)Editor/%(RecursiveDir)%(Filename)%(Extension)')"
              Condition="Exists('$(HubOutputDir)Editor')"/>

        <!-- Borrar dmg previo -->
        <Delete Files="$(DmgFileName)"/>

        <!-- Desmontar volumen previo si quedó montado -->
        <Exec Command="hdiutil detach /Volumes/Alis || true" IgnoreExitCode="true"/>

        <!-- Crear dmg con reintento por si Spotlight bloquea -->
        <Exec Command="bash -c '
      for i in {1..3}; do
        hdiutil create -volname Alis -srcfolder &quot;$(AppBundleDir)&quot; -ov -format UDZO &quot;$(DmgFileName)&quot; &amp;&amp; exit 0
        echo &quot;Retrying dmg creation in 5s...&quot;
        sleep 5
      done
      exit 1
    '"/>
    </Target>

    <Target Name="CreateLinuxBundle" AfterTargets="Build;Publish" Condition="$(AssemblyName.Equals('Alis.App.Hub')) And '$(IsLinux)' == 'true' AND $(Configuration) == 'Release'">
        <PropertyGroup>
            <PublishDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/publish/</PublishDir>
            <HubOutputDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/</HubOutputDir>
            <ZipFileName>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/Alis_$(RuntimeIdentifier).zip</ZipFileName>
        </PropertyGroup>
        <ItemGroup>
            <HubOutputFiles Include="$(HubOutputDir)**/*" Exclude="$(PublishDir)**/*;$(HubOutputDir)**/*.zip"/>
        </ItemGroup>
        <RemoveDir Directories="$(PublishDir)"/>
        <MakeDir Directories="$(PublishDir)"/>
        <CreateItem Include="@(EngineOutputFiles)" AdditionalMetadata="MyRecursiveDir=%(RecursiveDir)">
            <Output TaskParameter="Include" ItemName="EngineOutputFilesWithMyRecursiveDir"/>
        </CreateItem>
        <CreateItem Include="@(InstallerOutputFiles)" AdditionalMetadata="MyRecursiveDir=%(RecursiveDir)">
            <Output TaskParameter="Include" ItemName="InstallerOutputFilesWithMyRecursiveDir"/>
        </CreateItem>
        <CreateItem Include="@(HubOutputFiles)" AdditionalMetadata="MyRecursiveDir=%(RecursiveDir)">
            <Output TaskParameter="Include" ItemName="HubOutputFilesWithMyRecursiveDir"/>
        </CreateItem>
        <Copy SourceFiles="@(HubOutputFilesWithMyRecursiveDir)" DestinationFiles="@(HubOutputFilesWithMyRecursiveDir->'$(PublishDir)%(MyRecursiveDir)%(Filename)%(Extension)')"/>
        <ItemGroup>
            <EditorFiles Include="$(HubOutputDir)Editor/**/*"/>
        </ItemGroup>
        <Copy SourceFiles="@(EditorFiles)" DestinationFiles="@(EditorFiles->'$(PublishDir)Editor/%(RecursiveDir)%(Filename)%(Extension)')" Condition="Exists('$(HubOutputDir)Editor')"/>
        <Delete Files="$(ZipFileName)"/>
        <ZipDirectory SourceDirectory="$(PublishDir)" DestinationFile="$(ZipFileName)"/>
    </Target>

    <Target Name="CreateWindowsBundle" AfterTargets="Build;Publish" Condition="$(AssemblyName.Equals('Alis.App.Hub')) And '$(IsWindows)' == 'true' AND $(Configuration) == 'Release'">
        <PropertyGroup>
            <PublishDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/publish/</PublishDir>
            <HubOutputDir>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/</HubOutputDir>
            <ZipFileName>$(SolutionDir)1_Presentation/Hub/src/bin/$(Configuration)/$(RuntimeIdentifier)/lib/Alis_$(RuntimeIdentifier).zip</ZipFileName>
        </PropertyGroup>
        <ItemGroup>
            <HubOutputFiles Include="$(HubOutputDir)**/*" Exclude="$(PublishDir)**/*;$(HubOutputDir)**/*.zip"/>
        </ItemGroup>
        <RemoveDir Directories="$(PublishDir)"/>
        <MakeDir Directories="$(PublishDir)"/>
        <CreateItem Include="@(EngineOutputFiles)" AdditionalMetadata="MyRecursiveDir=%(RecursiveDir)">
            <Output TaskParameter="Include" ItemName="EngineOutputFilesWithMyRecursiveDir"/>
        </CreateItem>
        <CreateItem Include="@(InstallerOutputFiles)" AdditionalMetadata="MyRecursiveDir=%(RecursiveDir)">
            <Output TaskParameter="Include" ItemName="InstallerOutputFilesWithMyRecursiveDir"/>
        </CreateItem>
        <CreateItem Include="@(HubOutputFiles)" AdditionalMetadata="MyRecursiveDir=%(RecursiveDir)">
            <Output TaskParameter="Include" ItemName="HubOutputFilesWithMyRecursiveDir"/>
        </CreateItem>
        <Copy SourceFiles="@(HubOutputFilesWithMyRecursiveDir)" DestinationFiles="@(HubOutputFilesWithMyRecursiveDir->'$(PublishDir)%(MyRecursiveDir)%(Filename)%(Extension)')"/>
        <ItemGroup>
            <EditorFiles Include="$(HubOutputDir)Editor/**/*"/>
        </ItemGroup>
        <Copy SourceFiles="@(EditorFiles)" DestinationFiles="@(EditorFiles->'$(PublishDir)Editor/%(RecursiveDir)%(Filename)%(Extension)')" Condition="Exists('$(HubOutputDir)Editor')"/>
        <Delete Files="$(ZipFileName)"/>
        <ZipDirectory SourceDirectory="$(PublishDir)" DestinationFile="$(ZipFileName)"/>
    </Target>

    <PropertyGroup>
        <!-- Carpeta de recursos -->
        <AssetsDir>$(ProjectDir)Assets</AssetsDir>
        <!-- Nombre del zip y el txt generado -->
        <AssetsZip>$(ProjectDir)obj/assets.zip</AssetsZip>
        <AssetsOutput>$(ProjectDir)obj/assets.pack</AssetsOutput>
    </PropertyGroup>

    <Target Name="ZipAssets" BeforeTargets="BeforeRestore;BeforeBuild;Clean;Rebuild;Publish">
        <Message Text="ZipAssets: AssetsDir='$(AssetsDir)'; AssetsZip='$(AssetsZip)'; AssetsOutput='$(AssetsOutput)'" Importance="high"/>

        <!-- Windows: solo si existe el directorio -->
        <Exec Condition="Exists('$(AssetsDir)') AND '$(OS)' == 'Windows_NT'"
              Command="powershell -NoLogo -Command &quot;Compress-Archive -Path '$(AssetsDir)\\*' -DestinationPath '$(AssetsZip)' -Force; [Convert]::ToBase64String([System.IO.File]::ReadAllBytes('$(AssetsZip)')) | Out-File -FilePath '$(AssetsOutput)' -Encoding ASCII&quot;" />

        <!-- macOS/Linux: usar redirección para la compatibilidad con distintas implementaciones de base64 -->
        <Exec Condition="Exists('$(AssetsDir)') AND '$(OS)' != 'Windows_NT'"
              Command="sh -c &quot;zip -r -9 '$(AssetsZip)' '$(AssetsDir)' &amp;&amp; base64 &lt; '$(AssetsZip)' &gt; '$(AssetsOutput)'&quot;" />

        <!-- Si no existe AssetsDir, crear un archivo de salida vacío para no romper el build -->
        <Message Condition="!Exists('$(AssetsDir)')" Text="No existe el directorio `$(AssetsDir)`. Se genera `$(AssetsOutput)` vacío." Importance="high"/>

        <Exec Condition="!Exists('$(AssetsDir)') AND '$(OS)' == 'Windows_NT'"
              Command="powershell -NoLogo -Command &quot;Set-Content -Path '$(AssetsOutput)' -Value '' -Encoding ASCII&quot;" />

        <Exec Condition="!Exists('$(AssetsDir)') AND '$(OS)' != 'Windows_NT'"
              Command="sh -c &quot;mkdir -p '$(ProjectDir)obj' &amp;&amp; : &gt; '$(AssetsOutput)'&quot;" />
    </Target>

    <ItemGroup>
        <AdditionalFiles Include="$(AssetsOutput)" CopyToOutputDirectory="Never" CopyToPublishDirectory="Never" Visible="false" />
    </ItemGroup>



    <PropertyGroup Condition="'$(Configuration)'=='Release'">
        <!-- app.manifest file to use when building the project -->
        <ApplicationManifest>$(ProjectDir)Config/app.manifest</ApplicationManifest>

        <!-- Enables Ahead-of-Time (AOT) compilation for maximum performance and smaller binaries. -->
        <PublishAot>true</PublishAot>
        <!-- Publishes all dependencies with the app, so it runs independently of the system's .NET installation. -->
        <SelfContained>true</SelfContained>

        <!-- Uses invariant globalization to reduce the size by excluding culture-specific data. -->
        <InvariantGlobalization>true</InvariantGlobalization>
        <!-- Folds identical method bodies to reduce code duplication and binary size. -->
        <IlcFoldIdenticalMethodBodies>true</IlcFoldIdenticalMethodBodies>
        <!-- Disables reflection support to allow more aggressive trimming and reduce binary size. -->
        <IlcDisableReflection>true</IlcDisableReflection>

        <EnableTrimAnalyzer>true</EnableTrimAnalyzer>

        <IlcTrimMetadata>true</IlcTrimMetadata>

        <IlcGenerateStackTraceData>false</IlcGenerateStackTraceData>

        <!-- Disables stack trace support to save space, at the cost of less detailed error information. -->
        <StackTraceSupport>false</StackTraceSupport>
        <!-- Optimizes the build for size rather than speed. -->
        <OptimizationPreference>Size</OptimizationPreference>
        <IlcOptimizationPreference>Size</IlcOptimizationPreference>
        <!-- Removes debug information from the output, reducing binary size. -->
        <DebugType>none</DebugType>

        <!-- Generates a method statistics file for analysis; does not affect published size. -->
        <IlcGenerateMstatFile>true</IlcGenerateMstatFile>
        <!-- Generates a DGML graph file for code analysis; does not affect published size. -->
        <IlcGenerateDgmlFile>true</IlcGenerateDgmlFile>
        <!-- Generates a map file for code analysis; does not affect published size. -->
        <IlcGenerateMapFile>true</IlcGenerateMapFile>
        <!-- Dumps generated IL code for inspection; does not affect published size. -->
        <IlcDumpGeneratedIL>true</IlcDumpGeneratedIL>

        <TrimmerRemoveSymbols>true</TrimmerRemoveSymbols>


        <NoConfig>true</NoConfig>
        <Optimize>true</Optimize>

        <!-- Enables tree trimming to remove unused code and libraries, reducing the final binary size. -->
        <PublishTrimmed>true</PublishTrimmed>
        <!-- Aggressively trims unused assemblies and types; 'link' is the most space-saving mode. -->
        <TrimMode>link</TrimMode>
        <!-- Suppresses warnings about code that may be unsafe to trim, useful for aggressive size reduction. -->
        <SuppressTrimAnalysisWarnings>true</SuppressTrimAnalysisWarnings>
        <!-- Compresses files in single-file publish mode, further reducing disk footprint. -->
        <EnableCompressionInSingleFile>true</EnableCompressionInSingleFile>
        <!-- Removes debugging symbols from the output, saving space in the final binary. -->
        <StripSymbols>true</StripSymbols>
        <!-- Disables ReadyToRun compilation, which can increase binary size; only enable if startup performance is critical. -->
        <EnableReadyToRun>false</EnableReadyToRun>
        <!-- Ensures native libraries are extracted only when needed, reducing initial disk usage. -->
        <IncludeNativeLibrariesForSelfExtract>true</IncludeNativeLibrariesForSelfExtract>
        <!-- Allows unloading of unused assemblies, which can help reduce memory and disk usage in some scenarios. -->
        <EnableAssemblyLoadContextUnload>true</EnableAssemblyLoadContextUnload>
        <!-- Prevents inclusion of default items (like unnecessary files) in the build output, reducing published size. -->
        <EnableDefaultItems>true</EnableDefaultItems>
        <!-- Avoids copying unused satellite assemblies (localization resources), saving space if not needed. -->
        <CopyUnusedSatelliteAssemblies>false</CopyUnusedSatelliteAssemblies>
        <!-- Disables generation of XML documentation files, which are not needed for runtime and take extra space. -->
        <GenerateDocumentationFile>false</GenerateDocumentationFile>
        <!-- Prevents creation of reference assemblies, which are only needed for development, not for deployment. -->
        <ProduceReferenceAssembly>false</ProduceReferenceAssembly>
        <!-- Disables SourceLink, which embeds source control metadata and can increase output size. -->
        <EnableSourceLink>false</EnableSourceLink>
        <!-- Prevents generation of native debug symbols (.dSYM) on macOS. -->
        <DebugSymbols>false</DebugSymbols>

        <!-- Prevents generation of PDB files, which are not needed in production and take up space. -->
        <GenerateDebugSymbols>false</GenerateDebugSymbols>
    </PropertyGroup>


    <PropertyGroup Condition="'$(Configuration)'=='Debug'">
        <!-- app.manifest file to use when building the project -->
        <ApplicationManifest>$(ProjectDir)Config/app.manifest</ApplicationManifest>

        <!-- Enables Ahead-of-Time (AOT) compilation for maximum performance and smaller binaries. -->
        <PublishAot>true</PublishAot>
        <!-- Publishes all dependencies with the app, so it runs independently of the system's .NET installation. -->
        <SelfContained>true</SelfContained>

        <!-- Uses invariant globalization to reduce the size by excluding culture-specific data. -->
        <InvariantGlobalization>true</InvariantGlobalization>
        <!-- Folds identical method bodies to reduce code duplication and binary size. -->
        <IlcFoldIdenticalMethodBodies>true</IlcFoldIdenticalMethodBodies>
        <!-- Disables reflection support to allow more aggressive trimming and reduce binary size. -->
        <IlcDisableReflection>true</IlcDisableReflection>

        <EnableTrimAnalyzer>true</EnableTrimAnalyzer>

        <IlcTrimMetadata>true</IlcTrimMetadata>

        <IlcGenerateStackTraceData>true</IlcGenerateStackTraceData>

        <!-- Disables stack trace support to save space, at the cost of less detailed error information. -->
        <StackTraceSupport>true</StackTraceSupport>
        <!-- Optimizes the build for size rather than speed. -->
        <OptimizationPreference>Size</OptimizationPreference>
        <IlcOptimizationPreference>Size</IlcOptimizationPreference>

        <!-- Generates a method statistics file for analysis; does not affect published size. -->
        <IlcGenerateMstatFile>true</IlcGenerateMstatFile>
        <!-- Generates a DGML graph file for code analysis; does not affect published size. -->
        <IlcGenerateDgmlFile>true</IlcGenerateDgmlFile>
        <!-- Generates a map file for code analysis; does not affect published size. -->
        <IlcGenerateMapFile>true</IlcGenerateMapFile>
        <!-- Dumps generated IL code for inspection; does not affect published size. -->
        <IlcDumpGeneratedIL>true</IlcDumpGeneratedIL>

        <Optimize>true</Optimize>

        <!-- Enables tree trimming to remove unused code and libraries, reducing the final binary size. -->
        <PublishTrimmed>true</PublishTrimmed>
        <!-- Aggressively trims unused assemblies and types; 'link' is the most space-saving mode. -->
        <TrimMode>link</TrimMode>
        <!-- Suppresses warnings about code that may be unsafe to trim, useful for aggressive size reduction. -->
        <SuppressTrimAnalysisWarnings>false</SuppressTrimAnalysisWarnings>

        <!-- Compresses files in single-file publish mode, further reducing disk footprint. -->
        <EnableCompressionInSingleFile>true</EnableCompressionInSingleFile>

        <!-- Removes debugging symbols from the output, saving space in the final binary. -->
        <StripSymbols>true</StripSymbols>
        <!-- Disables ReadyToRun compilation, which can increase binary size; only enable if startup performance is critical. -->
        <EnableReadyToRun>false</EnableReadyToRun>
        <!-- Ensures native libraries are extracted only when needed, reducing initial disk usage. -->
        <IncludeNativeLibrariesForSelfExtract>true</IncludeNativeLibrariesForSelfExtract>
        <!-- Allows unloading of unused assemblies, which can help reduce memory and disk usage in some scenarios. -->
        <EnableAssemblyLoadContextUnload>true</EnableAssemblyLoadContextUnload>
        <!-- Prevents inclusion of default items (like unnecessary files) in the build output, reducing published size. -->
        <EnableDefaultItems>true</EnableDefaultItems>
        <!-- Avoids copying unused satellite assemblies (localization resources), saving space if not needed. -->
        <CopyUnusedSatelliteAssemblies>false</CopyUnusedSatelliteAssemblies>
        <!-- Disables generation of XML documentation files, which are not needed for runtime and take extra space. -->
        <GenerateDocumentationFile>false</GenerateDocumentationFile>
        <!-- Prevents creation of reference assemblies, which are only needed for development, not for deployment. -->
        <ProduceReferenceAssembly>false</ProduceReferenceAssembly>
        <!-- Disables SourceLink, which embeds source control metadata and can increase output size. -->
        <EnableSourceLink>false</EnableSourceLink>

        <!-- Prevents generation of PDB files, which are not needed in production and take up space. -->
        <GenerateDebugSymbols>false</GenerateDebugSymbols>
    </PropertyGroup>
    
    
    
</Project>